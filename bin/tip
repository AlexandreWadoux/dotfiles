#!/bin/bash

DIR=$(dirname $0)
TIP_FILE=$DIR/tips.md

if [ -n "$1" ]; then
    TIPS=$(egrep '^# ' $TIP_FILE | grep -i $1 | sed 's/^# //' | sort -f)
    NUM_MATCHES=$(echo "$TIPS" | wc -l)
    if [ -z "$TIPS" ]; then
        echo "No tip matching $1 found!"
        exit 1
    elif  [ $NUM_MATCHES != 1 ]; then
        ALTERNATIVES=$(echo "$TIPS" | tail -n+2 | tr '\n' ',' | sed 's/,$//' | sed 's/,/, /g')
        echo "Alternatives: "$ALTERNATIVES
        echo
    fi
    TIP=$(echo "$TIPS" | head -n1)
    echo "# $TIP"
    awk "/^# $TIP/ {flag=1;next} /^# /{flag=0} flag" $TIP_FILE
else
    echo "Help Topics"
    echo "==========="
    egrep "^# " $TIP_FILE | sort -f
fi
